This has to be generalised so that all our test-programs can use it.
